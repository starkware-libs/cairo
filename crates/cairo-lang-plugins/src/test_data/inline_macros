//! > Test consteval_int! macro

//! > test_runner_name
test_expand_plugin

//! > cairo_code
const a: felt252 = 0;

const b: felt252 = consteval_int!(4 + 5);

const c: felt252 = 4 + 5;

const d: felt252 = consteval_int!(23 + 4 * 5 + (4 + 5) / 2);

const e: u8 = consteval_int!(255 + 1 - 1);

//! > generated_cairo_code
const a: felt252 = 0;


const b: felt252 = 9;


const c: felt252 = 4 + 5;


const d: felt252 = 47;


const e: u8 = 255;

//! > expected_diagnostics

//! > ==========================================================================

//! > Test bad consteval_int! macros

//! > test_runner_name
test_expand_plugin

//! > cairo_code
const a: felt252 = consteval_int!(func_call(24));

const b: felt252 = consteval_int!('some string');

const c: felt252 = consteval_int!(*24);

const d: felt252 = consteval_int!(~24);

const e: felt252 = consteval_int!(234 < 5);

//! > generated_cairo_code
const a: felt252 = consteval_int!(func_call(24));


const b: felt252 = consteval_int!('some string');


const c: felt252 = consteval_int!(*24);


const d: felt252 = consteval_int!(~24);


const e: felt252 = consteval_int!(234 < 5);

//! > expected_diagnostics
error: Unsupported expression in consteval_int macro
 --> dummy_file.cairo:1:35
const a: felt252 = consteval_int!(func_call(24));
                                  ^***********^

error: Unsupported expression in consteval_int macro
 --> dummy_file.cairo:3:35
const b: felt252 = consteval_int!('some string');
                                  ^***********^

error: Unsupported unary operator in consteval_int macro
 --> dummy_file.cairo:5:35
const c: felt252 = consteval_int!(*24);
                                  ^*^

error: Unsupported unary operator in consteval_int macro
 --> dummy_file.cairo:7:35
const d: felt252 = consteval_int!(~24);
                                  ^*^

error: Unsupported binary operator in consteval_int macro
 --> dummy_file.cairo:9:35
const e: felt252 = consteval_int!(234 < 5);
                                  ^*****^

//! > ==========================================================================

//! > Test consteval_int! inside functions

//! > test_runner_name
test_expand_plugin

//! > cairo_code
fn some_func()
{
    return consteval_int!(4 + 5);
}

//! > generated_cairo_code
fn some_func()
{
    return 9;
}

//! > expected_diagnostics

//! > ==========================================================================

//! > Test recursive consteval_int! 

//! > test_runner_name
test_expand_plugin

//! > cairo_code
fn some_func()
{
    return consteval_int!(4 + consteval_int!(2+3));
}

//! > generated_cairo_code
fn some_func()
{
    return consteval_int!(4 + consteval_int!(2+3));
}

//! > expected_diagnostics
error: Unsupported expression in consteval_int macro
 --> dummy_file.cairo:3:31
    return consteval_int!(4 + consteval_int!(2+3));
                              ^*****************^

//! > ==========================================================================

//! > Test identity! macro

//! > test_runner_name
test_expand_plugin

//! > cairo_code
fn foo() {
    let x = identity!(0);
    let y = identity!('0');
    // TODO(Gil): Apply the macro recursively in test_expand_plugin.
    let z = identity!(identity!(0));
}

//! > generated_cairo_code
fn foo() {
    let x = 0;
    let y = '0';
    // TODO(Gil): Apply the macro recursively in test_expand_plugin.
    let z = identity!(0);
}

//! > expected_diagnostics

//! > ==========================================================================

//! > Test unknwon macro

//! > test_runner_name
test_expand_plugin

//! > cairo_code
fn foo() {
    let x = foo!(0);
}

//! > generated_cairo_code
fn foo() {
    let x = foo!(0);
}

//! > expected_diagnostics
error: Unknown inline macro: foo
 --> dummy_file.cairo:2:13
    let x = foo!(0);
            ^*****^
