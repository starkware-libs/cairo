//! > Negative impls

//! > test_runner_name
test_function_diagnostics(expect_diagnostics: false)

//! > function
fn foo(a: u8) -> Option<u8> {
    let b: Option<u8> = a.try_into();
    b
}

//! > function_name
foo

//! > module_code
use core::traits::TryInto;
pub trait DowncastableInt<Type>;

impl DowncastableIntU8 of DowncastableInt<u8> {}

pub trait TypeEq<S, T> {}

impl ImplTypeEq<T> of TypeEq<T, T> {}

impl DowncastableTryInto<
    From, To, +DowncastableInt<From>, +DowncastableInt<To>, -TypeEq<From, To>,
> of TryInto<From, To> {
    fn try_into(self: From) -> Option<To> {
        core::integer::downcast(self)
    }
}

//! > expected_diagnostics

//! > ==========================================================================

//! > Negative impls with generic args.

//! > test_runner_name
test_function_diagnostics(expect_diagnostics: true)

//! > function
fn foo(a: Span<u8>) -> u8 {
    let [a] = into_box(a).unbox();
    a
}

//! > function_name
foo

//! > module_code
fn into_box<T>(a: Span<T>) -> Box<[T; 1]> {
    *a.try_into().unwrap()
}

//! > expected_diagnostics
error: Cannot infer negative impl in `core::array::SpanTryIntoFixedSizedArray::<T, 1, _>` as it contains the unresolved type `[T; 1]`
 --> lib.cairo:2:8
    *a.try_into().unwrap()
       ^^^^^^^^
