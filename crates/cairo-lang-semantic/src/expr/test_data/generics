//! > Test generics substitution.

//! > test_function_name
test_function_diagnostics

//! > function
extern type A<S>;
extern fn bar<T>(x:T) -> A::<T> nopanic;

fn foo(a: A::<felt>) -> A::<A::<felt>> {
    let res = bar::<A::<felt>>(a);
    let bad : A::<A::<bool>> = res;
    res
}

//! > function_name
foo

//! > module_code

//! > expected_diagnostics
error: Unexpected argument type. Expected: "test::A::<test::A::<core::bool>>", found: "test::A::<test::A::<core::felt>>".
 --> lib.cairo:6:32
    let bad : A::<A::<bool>> = res;
                               ^*^

//! > ==========================================================================

//! > Test generics in trait functions.

//! > test_function_name
test_function_diagnostics

//! > function
fn foo() {
    5.foo(true);
    MyTrait::foo(6, false);
}

//! > module_code
trait MyTrait<T> {
    fn foo<S>(self: T, y: S) -> (T, S);
}
impl MyImpl of MyTrait::<felt> {
    fn foo<S>(self: felt, y: S) -> (felt, S) {
        (self, y)
    }
}

//! > function_name
foo

//! > expected_diagnostics

//! > ==========================================================================

//! > Test generic kind failures

//! > test_function_name
test_function_diagnostics

//! > function
fn foo() {
    bar::<1,1,1,1>();
    bar::<felt,felt>();
    bar::<felt>();
}

//! > module_code
fn bar<A, const B, impl C>(){}

//! > function_name
foo

//! > expected_diagnostics
error: Wrong number of generic arguments. Expected 3, found: 4
 --> lib.cairo:3:5
    bar::<1,1,1,1>();
    ^*^

error: Wrong kind of generic argument. Expected Type, found: Const
 --> lib.cairo:3:5
    bar::<1,1,1,1>();
    ^*^

error: Wrong kind of generic argument. Expected Impl, found: Const
 --> lib.cairo:3:5
    bar::<1,1,1,1>();
    ^*^

error: Wrong kind of generic argument. Expected Const, found: Type
 --> lib.cairo:4:5
    bar::<felt,felt>();
    ^*^

error: Impl generics not yet supported.
 --> lib.cairo:4:5
    bar::<felt,felt>();
    ^*^

error: Const generic inference not yet supported.
 --> lib.cairo:5:5
    bar::<felt>();
    ^*^
