//! > Test bad consteval_int! macros

//! > test_runner_name
test_function_diagnostics(expect_diagnostics: true)

//! > function
fn foo() {}

//! > function_name
foo

//! > module_code
const a: felt252 = consteval_int!(func_call(24));

const b: felt252 = consteval_int!('some string');

const c: felt252 = consteval_int!(*24);

const d: felt252 = consteval_int!(~24);

const e: felt252 = consteval_int!(234 < 5);

const e: felt252 = consteval_int![4 + 5];

const f: felt252 = consteval_int!{4 + 5};

const out_of_range: u8 = consteval_int!(120 + 160);

//! > expected_diagnostics
error: The name `e` is defined multiple times.
 --> lib.cairo:11:7
const e: felt252 = consteval_int![4 + 5];
      ^

error: Plugin diagnostic: Unsupported expression in consteval_int macro
 --> lib.cairo:1:35
const a: felt252 = consteval_int!(func_call(24));
                                  ^***********^

error: Only literal constants are currently supported.
 --> lib.cairo:1:20
const a: felt252 = consteval_int!(func_call(24));
                   ^***************************^

error: Plugin diagnostic: Unsupported expression in consteval_int macro
 --> lib.cairo:3:35
const b: felt252 = consteval_int!('some string');
                                  ^***********^

error: Only literal constants are currently supported.
 --> lib.cairo:3:20
const b: felt252 = consteval_int!('some string');
                   ^***************************^

error: Plugin diagnostic: Unsupported unary operator in consteval_int macro
 --> lib.cairo:5:35
const c: felt252 = consteval_int!(*24);
                                  ^*^

error: Only literal constants are currently supported.
 --> lib.cairo:5:20
const c: felt252 = consteval_int!(*24);
                   ^*****************^

error: Plugin diagnostic: Unsupported unary operator in consteval_int macro
 --> lib.cairo:7:35
const d: felt252 = consteval_int!(~24);
                                  ^*^

error: Only literal constants are currently supported.
 --> lib.cairo:7:20
const d: felt252 = consteval_int!(~24);
                   ^*****************^

error: Plugin diagnostic: Unsupported binary operator in consteval_int macro
 --> lib.cairo:9:35
const e: felt252 = consteval_int!(234 < 5);
                                  ^*****^

error: Only literal constants are currently supported.
 --> lib.cairo:9:20
const e: felt252 = consteval_int!(234 < 5);
                   ^*********************^

error: Plugin diagnostic: Macro `consteval_int` does not support this bracket type.
 --> lib.cairo:11:34
const e: felt252 = consteval_int![4 + 5];
                                 ^

error: Only literal constants are currently supported.
 --> lib.cairo:11:20
const e: felt252 = consteval_int![4 + 5];
                   ^*******************^

error: Plugin diagnostic: Macro `consteval_int` does not support this bracket type.
 --> lib.cairo:13:34
const f: felt252 = consteval_int!{4 + 5};
                                 ^

error: Only literal constants are currently supported.
 --> lib.cairo:13:20
const f: felt252 = consteval_int!{4 + 5};
                   ^*******************^

error: The value does not fit within the range of type core::integer::u8.
 --> lib.cairo:15:26
const out_of_range: u8 = consteval_int!(120 + 160);
                         ^***********************^

//! > ==========================================================================

//! > Test bad array! macros

//! > test_runner_name
test_function_diagnostics(expect_diagnostics: true)

//! > function
fn foo() {
    let x = array!(0);
    let x = array![0_felt252, 1_u8];
}

//! > function_name
foo

//! > module_code

//! > expected_diagnostics
error: Plugin diagnostic: Macro `array` does not support this bracket type.
 --> lib.cairo:2:19
    let x = array!(0);
                  ^

error: Plugin diagnostic: Unexpected argument type. Expected: "core::felt252", found: "core::integer::u8".
 --> lib.cairo:3:31
    let x = array![0_felt252, 1_u8];
                              ^**^

//! > ==========================================================================

//! > Test bad format! macros

//! > test_runner_name
test_function_diagnostics(expect_diagnostics: true)

//! > function
fn foo() {
   let ba: ByteArray = "hello";

   // Bad brackets.
   format!["{}", ba];

   // Less than 2 arguments.
   format!(ba);

   // More than 2 arguments.
   format!("{}", ba, 1);

   // First argument is not "{}".
   format!("{}{}", ba);
}

//! > function_name
foo

//! > module_code

//! > expected_diagnostics
error: Plugin diagnostic: Macro `format` does not support this bracket type.
 --> lib.cairo:5:11
   format!["{}", ba];
          ^

error: Plugin diagnostic: Argument must be a string literal.
 --> lib.cairo:8:12
   format!(ba);
           ^^

error: Plugin diagnostic: Unused argument.
 --> lib.cairo:11:22
   format!("{}", ba, 1);
                     ^

error: Plugin diagnostic: More format specifiers than arguments.
 --> lib.cairo:14:12
   format!("{}{}", ba);
           ^****^

//! > ==========================================================================

//! > Test bad print! macros

//! > test_runner_name
test_function_diagnostics(expect_diagnostics: true)

//! > function
fn foo() {
   let ba: ByteArray = "hello";

   // Bad brackets.
   print!["{}", ba];

   // Less than 2 arguments.
   print!(ba);

   // More than 2 arguments.
   print!("{}", ba, 1);

   // First argument is not "{}".
   print!("{}{}", ba);
}

//! > function_name
foo

//! > module_code

//! > expected_diagnostics
error: Plugin diagnostic: Macro `print` does not support this bracket type.
 --> lib.cairo:5:10
   print!["{}", ba];
         ^

error: Plugin diagnostic: Argument must be a string literal.
 --> lib.cairo:8:11
   print!(ba);
          ^^

error: Plugin diagnostic: Unused argument.
 --> lib.cairo:11:21
   print!("{}", ba, 1);
                    ^

error: Plugin diagnostic: More format specifiers than arguments.
 --> lib.cairo:14:11
   print!("{}{}", ba);
          ^****^

//! > ==========================================================================

//! > Test bad println! macros

//! > test_runner_name
test_function_diagnostics(expect_diagnostics: true)

//! > function
fn foo() {
   let ba: ByteArray = "hello";

   // Bad brackets.
   println!["{}", ba];

   // Less than 2 arguments.
   println!(ba);

   // More than 2 arguments.
   println!("{}", ba, 1);

   // First argument is not "{}".
   println!("{}{}", ba);
}

//! > function_name
foo

//! > module_code

//! > expected_diagnostics
error: Plugin diagnostic: Macro `println` does not support this bracket type.
 --> lib.cairo:5:12
   println!["{}", ba];
           ^

error: Plugin diagnostic: Argument must be a string literal.
 --> lib.cairo:8:13
   println!(ba);
            ^^

error: Plugin diagnostic: Unused argument.
 --> lib.cairo:11:23
   println!("{}", ba, 1);
                      ^

error: Plugin diagnostic: More format specifiers than arguments.
 --> lib.cairo:14:13
   println!("{}{}", ba);
            ^****^

//! > ==========================================================================

//! > Test unknown macro

//! > test_runner_name
test_function_diagnostics(expect_diagnostics: true)

//! > function
fn foo() {
   let x = foo!(0);
}

//! > function_name
foo

//! > module_code

//! > expected_diagnostics
error: Inline macro `foo` not found.
 --> lib.cairo:2:12
   let x = foo!(0);
           ^*****^

//! > ==========================================================================

//! > Test comment affects macro name

//! > test_runner_name
test_function_diagnostics(expect_diagnostics: false)

//! > function
fn foo() {
   // This comment should not appear in the macro name
   array![0_felt252];
}

//! > function_name
foo

//! > module_code

//! > expected_diagnostics
